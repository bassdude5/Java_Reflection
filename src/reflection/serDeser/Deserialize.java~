//---------------------------------------------------------------------
package reflection.serDeser;
//---------------------------------------------------------------------
import java.io.BufferedReader;
import java.io.FileReader;
import java.io.FileNotFoundException;
import reflection.serDeser.DeserializeTypes;
//---------------------------------------------------------------------
import java.util.regex.Matcher;
import java.util.regex.Pattern;
//---------------------------------------------------------------------
import reflection.util.Debug;
//---------------------------------------------------------------------
public class Deserialize
{
	private final int errorVal = 2;

	private Debug debugClass;
	private BufferedReader br;
	private DeserializeTypes dTypes;

	/**
	*	Class constructor
	**/
	public	Deserialize(Debug debugClass, String inputFilename) 
		throws FileNotFoundException
	{
		//Sets the debug class variable 
		this.debugClass = debugClass;

		//Sets up the DeserializeTypes class
		dTypes = new DeserializeTypes(debugClass);
				
		//Attempts to open the buffered reader
		try
		{
			br = new BufferedReader(new FileReader(inputFilename));
		}
		catch(FileNotFoundException e)
		{
			//Print the exception and the errorVal
			System.out.println("ERROR: Unable to open input file: \"" 
				+ inputFilename + "\"");
			System.exit(errorVal);	
		}
		finally
		{
			//Empty
		}
	}	

	/**
	*	This method deserializes a file and creates
	*	 the objects from the data file
	*
	*	@return Returns an array of objects that was
	*		 constructed from the input file
	**/
	public Object[] DeserializeFile() throws FileNotFoundException
	{
		String lineIn = " ";
		int i = 0;
		int intVal = 0;

		while(lineIn != null)
		{
			try
			{
				lineIn = br.readLine();
				
				if(lineIn != null)
				{
					if(i == 2)
					{
						//intVal = dTypes.DeserializeInt(lineIn);	
					}
					else
					{
						//System.out.println(lineIn);
					}				
				}
			}
			catch(Exception e)
			{
				System.out.println("ERROR: Unable to read"
					+ " line from input file!");
				System.exit(errorVal);
			}
			i++;
		}
	
		System.out.println("intVal value: " + intVal);

		return null;
	}

	/**
	*	This method is used to parse a string and return 
	*	 the string found based on the regular expression
	*	 values passed.
	*
	*	@return Returns the value found as a string
	**/
	public String parseValue(String lineIn, String regex1, 
		String regex2)
	{
		Pattern pat;
		Matcher match;
		String result = "";
		int begIndex = -1;
		int endIndex = -1;

		try
		{
			//Beginning tag parsing
			pat = Pattern.compile(regex1);
			match = pat.matcher(lineIn);
			if(match.find())
			{
				begIndex = match.end();
			}

			//End tag parsing
			pat = Pattern.compile(regex2);
			match = pat.matcher(lineIn);
			
			if(match.find())
			{
				endIndex = match.start();
			}	
		}
		catch(Exception e)
		{
			System.out.println("ERROR: attempted parse of" 
				+ "string: \"" + lineIn +"\"" +
				" failed!");
			System.exit(errorVal);
		}
		
		//Checks to ensure there actually was a value
		if(begIndex < endIndex && begIndex > 0)
		{
			result = inLine.substring(begIndex,endIndex);
		}

		return result;
	}

}//End of class Deserialize
//---------------------------------------------------------------------
